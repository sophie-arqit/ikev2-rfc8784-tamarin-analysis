<?xml version="1.0"?>
<!-- CPSA 4.4.3 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>IKEv2-PSK</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 4.4.3&quot;)
(comment &quot;Extracted shapes&quot;)
(herald IKEv2-PSK (algebra diffie-hellman))
(comment &quot;CPSA 4.4.3&quot;)
(comment &quot;All input read from rfc8784_ss.scm&quot;)</pre>

<p id="t0">Tree 0, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol ikev2_psk diffie-hellman
  (defrole init-rc
    (vars (i rki cci rndx)
      (SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
        nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
        ncc_resp data) (gr grkr gccr base) (psk ppk skey)
      (ID_init ID_resp id_ppk name))
    (trace
      (send
        (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init
          &quot;notify_useppk&quot;))
      (recv
        (cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; gr n_resp
          &quot;notify_useppk&quot;))
      (send
        (cat SPI_init SPI_resp &quot;msg3&quot;
          (enc ID_init
            (hash (hash psk &quot;KeyPadforIKEv2&quot;)
              (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i)
                n_init &quot;notify_useppk&quot;) n_resp
              (hmac ID_init
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                      n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
            &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat ID_init
              (hash (hash psk &quot;KeyPadforIKEv2&quot;)
                (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i)
                  n_init &quot;notify_useppk&quot;) n_resp
                (hmac ID_init
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
              &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;msg4&quot;
          (enc ID_resp
            (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; gr
              n_resp &quot;notify_useppk&quot; n_init
              (hmac ID_resp
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                      n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
            &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat ID_resp
              (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; gr
                n_resp &quot;notify_useppk&quot; n_init
                (hmac ID_resp
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
              &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;rekey_init&quot;
          (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init
            (exp (gen) rki)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init
              (exp (gen) rki))
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;rekey_resp&quot;
          (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
            grkr
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
              grkr)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init
            (exp (gen) cci)
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grkr rki) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;ei&quot;))
          (hmac
            (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init
              (exp (gen) cci))
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grkr rki) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;ai&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
            ncc_resp gccr
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grkr rki) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
              ncc_resp gccr)
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grkr rki) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;ar&quot;)))))
    (non-orig psk ppk)
    (uniq-gen SPI_init n_init SPI_init2 nrk_init SPIrk_init SPIcc_init
      ncc_init)
    (assume
      (exists ((ID_resp1 name)) (fact pskIDs psk ID_init ID_resp1)))
    (facts (isKeyIDFor id_ppk ppk)))
  (defrole resp-rc
    (vars (r rkr ccr rndx)
      (SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
        nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
        ncc_resp data) (gi grki gcci base) (psk ppk skey)
      (ID_init ID_resp id_ppk name))
    (trace
      (recv
        (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; gi n_init
          &quot;notify_useppk&quot;))
      (send
        (cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; (exp (gen) r)
          n_resp &quot;notify_useppk&quot;))
      (recv
        (cat SPI_init SPI_resp &quot;msg3&quot;
          (enc ID_init
            (hash (hash psk &quot;KeyPadforIKEv2&quot;)
              (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; gi n_init
                &quot;notify_useppk&quot;) n_resp
              (hmac ID_init
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                      n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
            &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat ID_init
              (hash (hash psk &quot;KeyPadforIKEv2&quot;)
                (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; gi n_init
                  &quot;notify_useppk&quot;) n_resp
                (hmac ID_init
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
              &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;msg4&quot;
          (enc ID_resp
            (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot;
              (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init
              (hmac ID_resp
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                      n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
            &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat ID_resp
              (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot;
                (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init
                (hmac ID_resp
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
              &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;rekey_init&quot;
          (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init grki
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init grki)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;rekey_resp&quot;
          (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
            (exp (gen) rkr)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
              (exp (gen) rkr))
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init gcci
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grki rkr) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;ei&quot;))
          (hmac
            (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init gcci)
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grki rkr) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;ai&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
            ncc_resp (exp (gen) ccr)
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grki rkr) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
              ncc_resp (exp (gen) ccr))
            (hash
              (cat
                (hash
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;)
                  (exp grki rkr) nrk_init nrk_resp) nrk_init nrk_resp
                SPIrk_init SPIrk_resp) &quot;ar&quot;)))))
    (non-orig psk ppk)
    (uniq-gen SPI_resp n_resp SPI_resp2 nrk_resp SPIrk_resp SPIcc_resp
      ncc_resp)
    (facts (pskIDs psk ID_init ID_resp) (isKeyIDFor id_ppk ppk)))
  (defrole init-cr
    (vars (i rki cci rndx)
      (SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
        nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
        ncc_resp data) (gr grkr gccr base) (psk ppk skey)
      (ID_init ID_resp id_ppk name))
    (trace
      (send
        (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init
          &quot;notify_useppk&quot;))
      (recv
        (cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; gr n_resp
          &quot;notify_useppk&quot;))
      (send
        (cat SPI_init SPI_resp &quot;msg3&quot;
          (enc ID_init
            (hash (hash psk &quot;KeyPadforIKEv2&quot;)
              (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i)
                n_init &quot;notify_useppk&quot;) n_resp
              (hmac ID_init
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                      n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
            &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat ID_init
              (hash (hash psk &quot;KeyPadforIKEv2&quot;)
                (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i)
                  n_init &quot;notify_useppk&quot;) n_resp
                (hmac ID_init
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
              &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;msg4&quot;
          (enc ID_resp
            (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; gr
              n_resp &quot;notify_useppk&quot; n_init
              (hmac ID_resp
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                      n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
            &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat ID_resp
              (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; gr
                n_resp &quot;notify_useppk&quot; n_init
                (hmac ID_resp
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gr i)) n_init
                        n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
              &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init
            (exp (gen) cci)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init
              (exp (gen) cci))
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
            ncc_resp gccr
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
              ncc_resp gccr)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;rekey_init&quot;
          (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init
            (exp (gen) rki)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init
              (exp (gen) rki))
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;rekey_resp&quot;
          (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
            grkr
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
              grkr)
            (hash
              (cat (prf (cat n_init n_resp) (exp gr i)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;)))))
    (non-orig psk ppk)
    (uniq-gen SPI_init n_init SPI_init2 nrk_init SPIrk_init SPIcc_init
      ncc_init)
    (assume
      (exists ((ID_resp1 name)) (fact pskIDs psk ID_init ID_resp1)))
    (facts (isKeyIDFor id_ppk ppk)))
  (defrole resp-cr
    (vars (r rkr ccr rndx)
      (SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
        nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
        ncc_resp data) (gi grki gcci base) (psk ppk skey)
      (ID_init ID_resp id_ppk name))
    (trace
      (recv
        (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; gi n_init
          &quot;notify_useppk&quot;))
      (send
        (cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; (exp (gen) r)
          n_resp &quot;notify_useppk&quot;))
      (recv
        (cat SPI_init SPI_resp &quot;msg3&quot;
          (enc ID_init
            (hash (hash psk &quot;KeyPadforIKEv2&quot;)
              (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; gi n_init
                &quot;notify_useppk&quot;) n_resp
              (hmac ID_init
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                      n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
            &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat ID_init
              (hash (hash psk &quot;KeyPadforIKEv2&quot;)
                (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; gi n_init
                  &quot;notify_useppk&quot;) n_resp
                (hmac ID_init
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;)))
              &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;msg4&quot;
          (enc ID_resp
            (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot;
              (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init
              (hmac ID_resp
                (prf ppk
                  (hash
                    (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                      n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
            &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat ID_resp
              (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot;
                (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init
                (hmac ID_resp
                  (prf ppk
                    (hash
                      (cat (prf (cat n_init n_resp) (exp gi r)) n_init
                        n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;)))
              &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init gcci
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac
            (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init gcci)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;create_child&quot;
          (enc &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
            ncc_resp (exp (gen) ccr)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp
              ncc_resp (exp (gen) ccr))
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;))))
      (recv
        (cat SPI_init SPI_resp &quot;rekey_init&quot;
          (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init grki
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ei&quot;))
          (hmac (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init grki)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ai&quot;))))
      (send
        (cat SPI_init SPI_resp &quot;rekey_resp&quot;
          (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
            (exp (gen) rkr)
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;er&quot;))
          (hmac
            (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp
              (exp (gen) rkr))
            (hash
              (cat (prf (cat n_init n_resp) (exp gi r)) n_init n_resp
                SPI_init SPI_resp) &quot;ar&quot;)))))
    (non-orig psk ppk)
    (uniq-gen SPI_resp n_resp SPI_resp2 nrk_resp SPIrk_resp SPIcc_resp
      ncc_resp)
    (facts (pskIDs psk ID_init ID_resp) (isKeyIDFor id_ppk ppk)))
  (defrule IDs_eq
    (forall ((ID_init1 ID_init2 ID_resp1 ID_resp2 name) (psk skey))
      (implies
        (and (fact pskIDs psk ID_init1 ID_resp1)
          (fact pskIDs psk ID_init2 ID_resp2))
        (and (= ID_init1 ID_init2) (= ID_resp1 ID_resp2)))))
  (defrule peerID_intro_rc
    (forall ((ID_init ID_resp name) (psk skey) (z strd))
      (implies
        (and (p &quot;init-rc&quot; &quot;psk&quot; z psk)
          (fact pskIDs psk ID_init ID_resp))
        (fact peerID z ID_resp))))
  (defrule peerID_intro_cr
    (forall ((ID_init ID_resp name) (psk skey) (z strd))
      (implies
        (and (p &quot;init-cr&quot; &quot;psk&quot; z psk)
          (fact pskIDs psk ID_init ID_resp))
        (fact peerID z ID_resp))))
  (defrule peerID_semantics_rc
    (forall ((ID_resp1 ID_resp2 name) (z strd))
      (implies
        (and (p &quot;init-rc&quot; &quot;ID_resp&quot; z ID_resp1)
          (fact peerID z ID_resp2))
        (= ID_resp1 ID_resp2))))
  (defrule peerID_semantics_cr
    (forall ((ID_resp1 ID_resp2 name) (z strd))
      (implies
        (and (p &quot;init-cr&quot; &quot;ID_resp&quot; z ID_resp1)
          (fact peerID z ID_resp2))
        (= ID_resp1 ID_resp2))))
  (defrule id_ppk_inj1
    (forall ((id_ppk name) (ppk1 ppk2 skey))
      (implies
        (and (fact isKeyIDFor id_ppk ppk1)
          (fact isKeyIDFor id_ppk ppk2))
        (= ppk1 ppk2))))
  (defrule id_ppk_inj2
    (forall ((id_ppk1 id_ppk2 name) (ppk skey))
      (implies
        (and (fact isKeyIDFor id_ppk1 ppk)
          (fact isKeyIDFor id_ppk2 ppk))
        (= id_ppk1 id_ppk2))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule fact-init-rc-isKeyIDFor0
    (forall ((z strd) (ppk skey) (id_ppk name))
      (implies
        (and (p &quot;init-rc&quot; z (idx 3)) (p &quot;init-rc&quot; &quot;id_ppk&quot; z id_ppk)
          (p &quot;init-rc&quot; &quot;ppk&quot; z ppk)) (fact isKeyIDFor id_ppk ppk))))
  (defgenrule fact-resp-rc-pskIDs1
    (forall ((z strd) (ID_resp ID_init name) (psk skey))
      (implies
        (and (p &quot;resp-rc&quot; z (idx 4)) (p &quot;resp-rc&quot; &quot;psk&quot; z psk)
          (p &quot;resp-rc&quot; &quot;ID_init&quot; z ID_init)
          (p &quot;resp-rc&quot; &quot;ID_resp&quot; z ID_resp))
        (fact pskIDs psk ID_init ID_resp))))
  (defgenrule fact-resp-rc-isKeyIDFor0
    (forall ((z strd) (ppk skey) (id_ppk name))
      (implies
        (and (p &quot;resp-rc&quot; z (idx 3)) (p &quot;resp-rc&quot; &quot;id_ppk&quot; z id_ppk)
          (p &quot;resp-rc&quot; &quot;ppk&quot; z ppk)) (fact isKeyIDFor id_ppk ppk))))
  (defgenrule fact-init-cr-isKeyIDFor0
    (forall ((z strd) (ppk skey) (id_ppk name))
      (implies
        (and (p &quot;init-cr&quot; z (idx 3)) (p &quot;init-cr&quot; &quot;id_ppk&quot; z id_ppk)
          (p &quot;init-cr&quot; &quot;ppk&quot; z ppk)) (fact isKeyIDFor id_ppk ppk))))
  (defgenrule fact-resp-cr-pskIDs1
    (forall ((z strd) (ID_resp ID_init name) (psk skey))
      (implies
        (and (p &quot;resp-cr&quot; z (idx 4)) (p &quot;resp-cr&quot; &quot;psk&quot; z psk)
          (p &quot;resp-cr&quot; &quot;ID_init&quot; z ID_init)
          (p &quot;resp-cr&quot; &quot;ID_resp&quot; z ID_resp))
        (fact pskIDs psk ID_init ID_resp))))
  (defgenrule fact-resp-cr-isKeyIDFor0
    (forall ((z strd) (ppk skey) (id_ppk name))
      (implies
        (and (p &quot;resp-cr&quot; z (idx 3)) (p &quot;resp-cr&quot; &quot;id_ppk&quot; z id_ppk)
          (p &quot;resp-cr&quot; &quot;ppk&quot; z ppk)) (fact isKeyIDFor id_ppk ppk))))
  (defgenrule assume-init-rc-0
    (forall ((z strd) (ID_init name) (psk skey))
      (implies
        (and (p &quot;init-rc&quot; z (idx 3)) (p &quot;init-rc&quot; &quot;psk&quot; z psk)
          (p &quot;init-rc&quot; &quot;ID_init&quot; z ID_init))
        (exists ((ID_resp1 name)) (fact pskIDs psk ID_init ID_resp1)))))
  (defgenrule assume-init-cr-0
    (forall ((z strd) (ID_init name) (psk skey))
      (implies
        (and (p &quot;init-cr&quot; z (idx 3)) (p &quot;init-cr&quot; &quot;psk&quot; z psk)
          (p &quot;init-cr&quot; &quot;ID_init&quot; z ID_init))
        (exists ((ID_resp1 name)) (fact pskIDs psk ID_init ID_resp1)))))
  (lang (hmac hash) (prf hash)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;create_child&quot; (enc &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp ncc_resp (exp (gen) ccr) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;er&quot;)) (hmac (cat &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp ncc_resp (exp (gen) ccr)) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ar&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;create_child&quot; (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init (exp (gen) cci) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ei&quot;)) (hmac (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init (exp (gen) cci)) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ai&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;rekey_resp&quot; (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp (exp (gen) rkr) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;er&quot;)) (hmac (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp (exp (gen) rkr)) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ar&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;rekey_init&quot; (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init (exp (gen) rki) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ei&quot;)) (hmac (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init (exp (gen) rki)) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ai&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg4&quot; (enc ID_resp (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init (hmac ID_resp (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot; (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;er&quot;)) (hmac (cat ID_resp (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init (hmac ID_resp (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ar&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg3&quot; (enc ID_init (hash (hash psk &quot;KeyPadforIKEv2&quot;) (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;) n_resp (hmac ID_init (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;))) &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ei&quot;)) (hmac (cat ID_init (hash (hash psk &quot;KeyPadforIKEv2&quot;) (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;) n_resp (hmac ID_init (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;))) &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ai&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot;)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SPI_init SPI_init) (SPI_resp SPI_resp) (n_init n_init) (n_resp n_resp) (SPI_init2 SPI_init2) (SPI_resp2 SPI_resp2) (nrk_init nrk_init) (nrk_resp nrk_resp) (SPIrk_init SPIrk_init) (SPIrk_resp SPIrk_resp) (SPIcc_init SPIcc_init) (SPIcc_resp SPIcc_resp) (ncc_init ncc_init) (ncc_resp ncc_resp) (psk psk) (ppk ppk) (ID_init ID_init) (ID_resp ID_resp) (id_ppk id_ppk) (gi (exp (gen) i)) (grki (exp (gen) rki)) (gcci (exp (gen) cci)) (r r) (rkr rkr) (ccr ccr))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>resp-rc</text>
   </g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>ikev2_psk 0</text>
  </svg></div>

<pre>(defskeleton ikev2_psk
  (vars
    (SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
      nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
      ncc_resp data) (psk ppk skey) (ID_init id_ppk ID_resp name)
    (i rki cci r rkr ccr rndx))
  (defstrand resp-rc 8 (SPI_init SPI_init) (SPI_resp SPI_resp)
    (n_init n_init) (n_resp n_resp) (SPI_init2 SPI_init2)
    (SPI_resp2 SPI_resp2) (nrk_init nrk_init) (nrk_resp nrk_resp)
    (SPIrk_init SPIrk_init) (SPIrk_resp SPIrk_resp)
    (SPIcc_init SPIcc_init) (SPIcc_resp SPIcc_resp) (ncc_init ncc_init)
    (ncc_resp ncc_resp) (psk psk) (ppk ppk) (ID_init ID_init)
    (ID_resp ID_resp) (id_ppk id_ppk) (gi (exp (gen) i))
    (grki (exp (gen) rki)) (gcci (exp (gen) cci)) (r r) (rkr rkr)
    (ccr ccr))
  (non-orig psk ppk)
  (uniq-gen SPI_resp n_resp SPI_resp2 nrk_resp SPIrk_resp SPIcc_resp
    ncc_resp)
  (goals
    (forall
      ((SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
         nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
         ncc_resp data) (psk ppk skey) (ID_init id_ppk ID_resp name)
        (i rki cci r rkr ccr rndx) (z strd))
      (implies
        (and (p &quot;resp-rc&quot; z 8) (p &quot;resp-rc&quot; &quot;SPI_init&quot; z SPI_init)
          (p &quot;resp-rc&quot; &quot;SPI_resp&quot; z SPI_resp)
          (p &quot;resp-rc&quot; &quot;n_init&quot; z n_init)
          (p &quot;resp-rc&quot; &quot;n_resp&quot; z n_resp)
          (p &quot;resp-rc&quot; &quot;SPI_init2&quot; z SPI_init2)
          (p &quot;resp-rc&quot; &quot;SPI_resp2&quot; z SPI_resp2)
          (p &quot;resp-rc&quot; &quot;nrk_init&quot; z nrk_init)
          (p &quot;resp-rc&quot; &quot;nrk_resp&quot; z nrk_resp)
          (p &quot;resp-rc&quot; &quot;SPIrk_init&quot; z SPIrk_init)
          (p &quot;resp-rc&quot; &quot;SPIrk_resp&quot; z SPIrk_resp)
          (p &quot;resp-rc&quot; &quot;SPIcc_init&quot; z SPIcc_init)
          (p &quot;resp-rc&quot; &quot;SPIcc_resp&quot; z SPIcc_resp)
          (p &quot;resp-rc&quot; &quot;ncc_init&quot; z ncc_init)
          (p &quot;resp-rc&quot; &quot;ncc_resp&quot; z ncc_resp) (p &quot;resp-rc&quot; &quot;psk&quot; z psk)
          (p &quot;resp-rc&quot; &quot;ppk&quot; z ppk) (p &quot;resp-rc&quot; &quot;ID_init&quot; z ID_init)
          (p &quot;resp-rc&quot; &quot;ID_resp&quot; z ID_resp)
          (p &quot;resp-rc&quot; &quot;id_ppk&quot; z id_ppk)
          (p &quot;resp-rc&quot; &quot;gi&quot; z (exp (gen) i))
          (p &quot;resp-rc&quot; &quot;grki&quot; z (exp (gen) rki))
          (p &quot;resp-rc&quot; &quot;gcci&quot; z (exp (gen) cci)) (p &quot;resp-rc&quot; &quot;r&quot; z r)
          (p &quot;resp-rc&quot; &quot;rkr&quot; z rkr) (p &quot;resp-rc&quot; &quot;ccr&quot; z ccr) (non psk)
          (non ppk) (ugen SPI_resp) (ugen n_resp) (ugen SPI_resp2)
          (ugen nrk_resp) (ugen SPIrk_resp) (ugen SPIcc_resp)
          (ugen ncc_resp))
        (exists ((SPI_init2-0 SPI_resp2-0 data) (z-0 strd))
          (and (p &quot;init-rc&quot; z-0 7) (p &quot;init-rc&quot; &quot;SPI_init&quot; z-0 SPI_init)
            (p &quot;init-rc&quot; &quot;SPI_resp&quot; z-0 SPI_resp)
            (p &quot;init-rc&quot; &quot;n_init&quot; z-0 n_init)
            (p &quot;init-rc&quot; &quot;n_resp&quot; z-0 n_resp)
            (p &quot;init-rc&quot; &quot;SPI_init2&quot; z-0 SPI_init2-0)
            (p &quot;init-rc&quot; &quot;SPI_resp2&quot; z-0 SPI_resp2-0)
            (p &quot;init-rc&quot; &quot;nrk_init&quot; z-0 nrk_init)
            (p &quot;init-rc&quot; &quot;nrk_resp&quot; z-0 nrk_resp)
            (p &quot;init-rc&quot; &quot;SPIrk_init&quot; z-0 SPIrk_init)
            (p &quot;init-rc&quot; &quot;SPIrk_resp&quot; z-0 SPIrk_resp)
            (p &quot;init-rc&quot; &quot;SPIcc_init&quot; z-0 SPIcc_init)
            (p &quot;init-rc&quot; &quot;SPIcc_resp&quot; z-0 SPIcc_resp)
            (p &quot;init-rc&quot; &quot;ncc_init&quot; z-0 ncc_init)
            (p &quot;init-rc&quot; &quot;ncc_resp&quot; z-0 ncc_resp)
            (p &quot;init-rc&quot; &quot;psk&quot; z-0 psk) (p &quot;init-rc&quot; &quot;ppk&quot; z-0 ppk)
            (p &quot;init-rc&quot; &quot;ID_init&quot; z-0 ID_init)
            (p &quot;init-rc&quot; &quot;ID_resp&quot; z-0 ID_resp)
            (p &quot;init-rc&quot; &quot;id_ppk&quot; z-0 id_ppk)
            (p &quot;init-rc&quot; &quot;gr&quot; z-0 (exp (gen) r))
            (p &quot;init-rc&quot; &quot;grkr&quot; z-0 (exp (gen) rkr))
            (p &quot;init-rc&quot; &quot;gccr&quot; z-0 (exp (gen) ccr))
            (p &quot;init-rc&quot; &quot;i&quot; z-0 i) (p &quot;init-rc&quot; &quot;rki&quot; z-0 rki)
            (p &quot;init-rc&quot; &quot;cci&quot; z-0 cci) (fact peerID z ID_init)
            (fact pskIDs psk ID_init ID_resp)
            (fact isKeyIDFor id_ppk ppk))))))
  (label 0)
  (unrealized (0 2) (0 6))
  (origs)
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;create_child&quot; (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init (exp (gen) cci) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ei&quot;)) (hmac (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init (exp (gen) cci)) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ai&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;rekey_resp&quot; (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp (exp (gen) (mul rki rkr (rec rki-0))) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;er&quot;)) (hmac (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp (exp (gen) (mul rki rkr (rec rki-0)))) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ar&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;rekey_init&quot; (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init (exp (gen) rki-0) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ei&quot;)) (hmac (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init (exp (gen) rki-0)) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ai&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg4&quot; (enc ID_resp (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init (hmac ID_resp (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) &quot;SAr2_algorithms&quot; SPI_resp2-0 &quot;use_ppk&quot; (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;er&quot;)) (hmac (cat ID_resp (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init (hmac ID_resp (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) &quot;SAr2_algorithms&quot; SPI_resp2-0 &quot;use_ppk&quot;) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ar&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg3&quot; (enc ID_init (hash (hash psk &quot;KeyPadforIKEv2&quot;) (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;) n_resp (hmac ID_init (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;))) &quot;SAi2_algorithms&quot; SPI_init2-0 &quot;use_ppk&quot; id_ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ei&quot;)) (hmac (cat ID_init (hash (hash psk &quot;KeyPadforIKEv2&quot;) (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;) n_resp (hmac ID_init (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;))) &quot;SAi2_algorithms&quot; SPI_init2-0 &quot;use_ppk&quot; id_ppk) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ai&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot;)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;create_child&quot; (enc &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp ncc_resp (exp (gen) ccr) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;er&quot;)) (hmac (cat &quot;SAr_create_child_algorithms&quot; SPIcc_init SPIcc_resp ncc_resp (exp (gen) ccr)) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ar&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;create_child&quot; (enc &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init (exp (gen) cci) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ei&quot;)) (hmac (cat &quot;SAi_create_child_algorithms&quot; SPIcc_init ncc_init (exp (gen) cci)) (hash (cat (hash (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;d&quot;) &quot;0x01&quot;) (exp (gen) (mul rki rkr)) nrk_init nrk_resp) nrk_init nrk_resp SPIrk_init SPIrk_resp) &quot;ai&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;rekey_resp&quot; (enc &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp (exp (gen) rkr) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;er&quot;)) (hmac (cat &quot;SAr_rekey_algorithms&quot; SPIrk_init SPIrk_resp nrk_resp (exp (gen) rkr)) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ar&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;rekey_init&quot; (enc &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init (exp (gen) rki) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ei&quot;)) (hmac (cat &quot;SAi_rekey_algorithms&quot; SPIrk_init nrk_init (exp (gen) rki)) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ai&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg4&quot; (enc ID_resp (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init (hmac ID_resp (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot; (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;er&quot;)) (hmac (cat ID_resp (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot; n_init (hmac ID_resp (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) &quot;SAr2_algorithms&quot; SPI_resp2 &quot;use_ppk&quot;) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ar&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg3&quot; (enc ID_init (hash (hash psk &quot;KeyPadforIKEv2&quot;) (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;) n_resp (hmac ID_init (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;))) &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ei&quot;)) (hmac (cat ID_init (hash (hash psk &quot;KeyPadforIKEv2&quot;) (cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;) n_resp (hmac ID_init (prf ppk (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;pi&quot;) &quot;0x01&quot;))) &quot;SAi2_algorithms&quot; SPI_init2 &quot;use_ppk&quot; id_ppk) (hash (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init n_resp SPI_init SPI_resp) &quot;ai&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat SPI_init SPI_resp &quot;msg2&quot; &quot;SAr1_algorithms&quot; (exp (gen) r) n_resp &quot;notify_useppk&quot;)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat SPI_init &quot;0&quot; &quot;msg1&quot; &quot;SAi1_algorithms&quot; (exp (gen) i) n_init &quot;notify_useppk&quot;)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SPI_init SPI_init) (SPI_resp SPI_resp) (n_init n_init) (n_resp n_resp) (SPI_init2 SPI_init2-0) (SPI_resp2 SPI_resp2-0) (nrk_init nrk_init) (nrk_resp nrk_resp) (SPIrk_init SPIrk_init) (SPIrk_resp SPIrk_resp) (SPIcc_init SPIcc_init) (ncc_init ncc_init) (psk psk) (ppk ppk) (ID_init ID_init) (ID_resp ID_resp) (id_ppk id_ppk) (gr (exp (gen) r)) (grkr (exp (gen) (mul rki rkr (rec rki-0)))) (i i) (rki rki-0) (cci cci))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>init-rc</text>
   </g>
  <g>
   <title>((SPI_init SPI_init) (SPI_resp SPI_resp) (n_init n_init) (n_resp n_resp) (SPI_init2 SPI_init2) (SPI_resp2 SPI_resp2) (nrk_init nrk_init) (nrk_resp nrk_resp) (SPIrk_init SPIrk_init) (SPIrk_resp SPIrk_resp) (SPIcc_init SPIcc_init) (SPIcc_resp SPIcc_resp) (ncc_init ncc_init) (ncc_resp ncc_resp) (psk psk) (ppk ppk) (ID_init ID_init) (ID_resp ID_resp) (id_ppk id_ppk) (gi (exp (gen) i)) (grki (exp (gen) rki)) (gcci (exp (gen) cci)) (r r) (rkr rkr) (ccr ccr))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>resp-rc</text>
   </g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>ikev2_psk 6</text>
  </svg></div>

<pre>(defskeleton ikev2_psk
  (vars
    (SPI_init SPI_resp n_init n_resp SPI_init2 SPI_resp2 nrk_init
      nrk_resp SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init
      ncc_resp SPI_init2-0 SPI_resp2-0 data) (ppk psk skey)
    (ID_resp ID_init id_ppk name) (rki rkr ccr rki-0 cci i r rndx))
  (defstrand resp-rc 8 (SPI_init SPI_init) (SPI_resp SPI_resp)
    (n_init n_init) (n_resp n_resp) (SPI_init2 SPI_init2)
    (SPI_resp2 SPI_resp2) (nrk_init nrk_init) (nrk_resp nrk_resp)
    (SPIrk_init SPIrk_init) (SPIrk_resp SPIrk_resp)
    (SPIcc_init SPIcc_init) (SPIcc_resp SPIcc_resp) (ncc_init ncc_init)
    (ncc_resp ncc_resp) (psk psk) (ppk ppk) (ID_init ID_init)
    (ID_resp ID_resp) (id_ppk id_ppk) (gi (exp (gen) i))
    (grki (exp (gen) rki)) (gcci (exp (gen) cci)) (r r) (rkr rkr)
    (ccr ccr))
  (defstrand init-rc 7 (SPI_init SPI_init) (SPI_resp SPI_resp)
    (n_init n_init) (n_resp n_resp) (SPI_init2 SPI_init2-0)
    (SPI_resp2 SPI_resp2-0) (nrk_init nrk_init) (nrk_resp nrk_resp)
    (SPIrk_init SPIrk_init) (SPIrk_resp SPIrk_resp)
    (SPIcc_init SPIcc_init) (ncc_init ncc_init) (psk psk) (ppk ppk)
    (ID_init ID_init) (ID_resp ID_resp) (id_ppk id_ppk)
    (gr (exp (gen) r)) (grkr (exp (gen) (mul rki rkr (rec rki-0))))
    (i i) (rki rki-0) (cci cci))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((0 5) (1 5)) ((1 0) (0 0))
    ((1 2) (0 2)) ((1 4) (0 4)) ((1 6) (0 6)))
  (non-orig ppk psk)
  (uniq-gen SPI_init SPI_resp n_init n_resp SPI_resp2 nrk_init nrk_resp
    SPIrk_init SPIrk_resp SPIcc_init SPIcc_resp ncc_init ncc_resp
    SPI_init2-0)
  (facts (peerID 1 ID_resp) (pskIDs psk ID_init ID_resp)
    (isKeyIDFor id_ppk ppk))
  (rule fact-resp-cr-isKeyIDFor0 fact-resp-cr-pskIDs1 peerID_intro_cr)
  (operation encryption-test (displaced 2 0 resp-cr 4)
    (hash (hash psk &quot;KeyPadforIKEv2&quot;) &quot;SAr1_algorithms&quot; (exp (gen) r)
      n_resp &quot;notify_useppk&quot; n_init
      (hmac ID_resp
        (prf ppk
          (hash
            (cat (prf (cat n_init n_resp) (exp (gen) (mul i r))) n_init
              n_resp SPI_init SPI_resp) &quot;pr&quot;) &quot;0x01&quot;))) (1 3))
  (label 6)
  (parent 0)
  (realized)
  (shape)
  (satisfies
    (no (p &quot;init-rc&quot; &quot;SPIcc_resp&quot; z-0 SPIcc_resp) (SPI_init SPI_init)
      (SPI_resp SPI_resp) (n_init n_init) (n_resp n_resp)
      (SPI_init2 SPI_init2) (SPI_resp2 SPI_resp2) (nrk_init nrk_init)
      (nrk_resp nrk_resp) (SPIrk_init SPIrk_init)
      (SPIrk_resp SPIrk_resp) (SPIcc_init SPIcc_init)
      (SPIcc_resp SPIcc_resp) (ncc_init ncc_init) (ncc_resp ncc_resp)
      (psk psk) (ppk ppk) (ID_init ID_init) (id_ppk id_ppk)
      (ID_resp ID_resp) (i i) (rki rki) (cci cci) (r r) (rkr rkr)
      (ccr ccr) (z 0)))
  (maps
    ((0)
      ((SPI_init SPI_init) (SPI_resp SPI_resp) (n_init n_init)
        (n_resp n_resp) (SPI_init2 SPI_init2) (SPI_resp2 SPI_resp2)
        (nrk_init nrk_init) (nrk_resp nrk_resp) (SPIrk_init SPIrk_init)
        (SPIrk_resp SPIrk_resp) (SPIcc_init SPIcc_init)
        (SPIcc_resp SPIcc_resp) (ncc_init ncc_init) (ncc_resp ncc_resp)
        (psk psk) (ppk ppk) (ID_init ID_init) (id_ppk id_ppk)
        (ID_resp ID_resp) (i i) (rki rki) (cci cci) (r r) (rkr rkr)
        (ccr ccr))))
  (origs))</pre>

</body>
</html>
